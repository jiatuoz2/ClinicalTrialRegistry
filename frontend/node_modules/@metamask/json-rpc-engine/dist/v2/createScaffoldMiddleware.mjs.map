{"version":3,"file":"createScaffoldMiddleware.mjs","sourceRoot":"","sources":["../../src/v2/createScaffoldMiddleware.ts"],"names":[],"mappings":"AA8BA;;;;;;;;GAQG;AACH,MAAM,UAAU,wBAAwB,CACtC,QAAqC;IAErC,OAAO,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,EAAE,EAAE;QACpC,MAAM,eAAe,GAAG,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QACjD,IAAI,eAAe,KAAK,SAAS,EAAE,CAAC;YAClC,OAAO,IAAI,EAAE,CAAC;QAChB,CAAC;QAED,OAAO,OAAO,eAAe,KAAK,UAAU;YAC1C,CAAC,CAAC,eAAe,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC;YAC7C,CAAC,CAAC,eAAe,CAAC;IACtB,CAAC,CAAC;AACJ,CAAC","sourcesContent":["import type { Json, JsonRpcParams, JsonRpcRequest } from '@metamask/utils';\n\nimport type { JsonRpcMiddleware } from './JsonRpcEngineV2';\nimport type { ContextConstraint, MiddlewareContext } from './MiddlewareContext';\n\n// Only permit primitive values as hard-coded scaffold middleware results.\ntype JsonPrimitive = string | number | boolean | null;\n\n/**\n * A handler for a scaffold middleware function.\n *\n * @template Params - The parameters of the request.\n * @template Result - The result of the request.\n * @template Context - The context of the request.\n * @returns A JSON-RPC middleware function or a primitive JSON value.\n */\nexport type ScaffoldMiddlewareHandler<\n  Params extends JsonRpcParams,\n  Result extends Json,\n  Context extends ContextConstraint,\n> = JsonRpcMiddleware<JsonRpcRequest<Params>, Result, Context> | JsonPrimitive;\n\n/**\n * A record of RPC method handler functions or hard-coded results, keyed to particular method names.\n * Only primitive JSON values are permitted as hard-coded results.\n */\nexport type MiddlewareScaffold<\n  Context extends ContextConstraint = MiddlewareContext,\n> = Record<string, ScaffoldMiddlewareHandler<JsonRpcParams, Json, Context>>;\n\n/**\n * Creates a middleware function from an object of RPC method handler functions,\n * keyed to particular method names. If a method corresponding to a key of this\n * object is requested, this middleware will pass it to the corresponding\n * handler and return the result.\n *\n * @param handlers - The RPC method handler functions.\n * @returns The scaffold middleware function.\n */\nexport function createScaffoldMiddleware<Context extends ContextConstraint>(\n  handlers: MiddlewareScaffold<Context>,\n): JsonRpcMiddleware<JsonRpcRequest, Json, Context> {\n  return ({ request, context, next }) => {\n    const handlerOrResult = handlers[request.method];\n    if (handlerOrResult === undefined) {\n      return next();\n    }\n\n    return typeof handlerOrResult === 'function'\n      ? handlerOrResult({ request, context, next })\n      : handlerOrResult;\n  };\n}\n"]}